/* 用户互动页面。
 * 
 * 林碳白
 * 202年4月7日
 */
#include "zf_common_headfile.h"

const uint8 IDP[][16]={//防灾科技学院汉字字模
    {0x00,0xFE,0x02,0x22,0xDA,0x06,0x08,0x08,0xF8,0x89,0x8E,0x88,0x88,0x88,0x08,0x00},
    {0x00,0xFF,0x08,0x10,0x08,0x87,0x40,0x30,0x0F,0x00,0x40,0x80,0x40,0x3F,0x00,0x00},//"防",0
    {0x10,0x0C,0x04,0xC4,0x04,0x04,0x05,0xF6,0x04,0x04,0x04,0x04,0xC4,0x14,0x0C,0x00},
    {0x80,0x80,0x42,0x41,0x20,0x10,0x0C,0x03,0x0C,0x10,0x22,0x41,0x40,0x80,0x80,0x00},//"灾",1
    {0x24,0x24,0xA4,0xFE,0xA3,0x22,0x00,0x22,0xCC,0x00,0x00,0xFF,0x00,0x00,0x00,0x00},
    {0x08,0x06,0x01,0xFF,0x00,0x01,0x04,0x04,0x04,0x04,0x04,0xFF,0x02,0x02,0x02,0x00},//"科",2
    {0x10,0x10,0x10,0xFF,0x10,0x90,0x08,0x88,0x88,0x88,0xFF,0x88,0x88,0x88,0x08,0x00},
    {0x04,0x44,0x82,0x7F,0x01,0x80,0x80,0x40,0x43,0x2C,0x10,0x28,0x46,0x81,0x80,0x00},//"技",3
    {0x40,0x30,0x11,0x96,0x90,0x90,0x91,0x96,0x90,0x90,0x98,0x14,0x13,0x50,0x30,0x00},
    {0x04,0x04,0x04,0x04,0x04,0x44,0x84,0x7E,0x06,0x05,0x04,0x04,0x04,0x04,0x04,0x00},//"学",4
    {0x00,0xFE,0x22,0x5A,0x86,0x10,0x0C,0x24,0x24,0x25,0x26,0x24,0x24,0x14,0x0C,0x00},
    {0x00,0xFF,0x04,0x08,0x07,0x80,0x41,0x31,0x0F,0x01,0x01,0x3F,0x41,0x41,0x71,0x00},//"院",5
};

const uint8 copyright[][16]={//版权汉字字模
    {0x00,0xFE,0x20,0x20,0x3F,0x20,0x00,0xFC,0x24,0xE4,0x24,0x22,0x23,0xE2,0x00,0x00},
    {0x80,0x7F,0x01,0x01,0xFF,0x80,0x60,0x1F,0x80,0x41,0x26,0x18,0x26,0x41,0x80,0x00},//"版",0
    {0x10,0x10,0xD0,0xFF,0x90,0x10,0x02,0x1E,0xE2,0x02,0x02,0x02,0xE2,0x1E,0x00,0x00},
    {0x04,0x03,0x00,0xFF,0x00,0x83,0x80,0x40,0x20,0x13,0x0C,0x13,0x20,0x40,0x80,0x00},//"权",1
    {0x00,0x00,0xFC,0x24,0x24,0x22,0xE3,0x02,0xFC,0x44,0x44,0x42,0xC3,0x42,0x40,0x00},
    {0x40,0x30,0x0F,0x02,0x02,0x82,0x43,0x30,0x0F,0x00,0x00,0x00,0xFF,0x00,0x00,0x00},//"所",2
    {0x04,0x04,0x04,0x84,0xE4,0x3C,0x27,0x24,0x24,0x24,0x24,0xE4,0x04,0x04,0x04,0x00},
    {0x04,0x02,0x01,0x00,0xFF,0x09,0x09,0x09,0x09,0x49,0x89,0x7F,0x00,0x00,0x00,0x00},//"有",3
};

uint8 now_page=0;//当前页面
uint8 gogogo=0;//1=正式发车

uint8 point=0;

enum PAGE
{
    MASTER,
    START,
    TET,
    CP,

} NOW_PAGE;

void menu(void){//用户互动页面
    first_page();
    while(!gogogo){
        oled_clear();
        switch(now_page){
            case MASTER:page_MASTER_show();break;
            default: page_error();
        }
        key_scanner();
        switch(now_page){
            case MASTER:page_MASTER_ex();break;
            default: page_error();
        }
    }
}

/*其实为了节约内存，你可以选择在进入未定义页面时
  直接返回主页。就算要写一个错误页面，也不用写这
  么一大串没用的玩意。你写给谁看呢？而且事实上，
  当你完成程序的时候，根本不会再出现这种问题。
  所以，我设计这个页面的意义到底是什么？为什么
  我要在凌晨1点钟思考这个？难道真的没有别的事情
  需要做了吗？感觉你的人生就像是这个页面一样 失 败 不 堪。*/
void page_error(void){
    oled_show_string(0,0,"ERROR:"          );
    oled_show_string(0,1,"UNDERINED_PAGE"  );
    oled_show_string(0,2,"ERR_PG:"         );
    oled_show_uint( 36 , 2 , now_page , 10 );
    oled_show_string(0,3,"You're trying go");
    oled_show_string(0,4,"to an UNDERINED ");
    oled_show_string(0,5,"page! Dont worr-");
    oled_show_string(0,6,"-y,we'll back to");
    oled_show_string(0,7,"the MASTER page.");
    system_delay_ms(1000);
    now_page=0;
}

//启动页面
void first_page(void){
    oled_clear();
    oled_show_chinese(0, 0, 16,(const uint8 *)IDP,6);
    oled_show_string(0,3,"BIKE_OFF_ROAD"   );
    oled_show_string(0,5,"Author:"         );
    oled_show_string(0,6,"Feng W., Qiu R.,");
    oled_show_string(0,7,"Qin G.Q."        );
    system_delay_ms(1500);
    oled_clear();
    oled_show_chinese(0, 0, 16, (const uint8 *)copyright,4);
    oled_show_string(0,5,"(C) 408SIC 2023,");
    oled_show_string(0,6,"All Rights------");
    oled_show_string(0,7,"-------Reserved.");
    system_delay_ms(1500);
}

void page_MASTER_show(){
    oled_show_string(0,0,"Bike DOS v1.0"   );
    oled_show_string(0,1,"./"              );
  //oled_show_string(0,2,""                );
    oled_show_string(0,3,"  START"         );//执行发车程序
    oled_show_string(0,4,"  test Ext.eq."  );//测试外设
    oled_show_string(0,5,"  chk. params."  );//改变参数
  //oled_show_string(0,6,""                );
    oled_show_string(0,7,"A8>B12 > U>R>C>D");

    oled_show_string(0,3+point,"->"        );
}

void page_MASTER_ex(){
    if(KEY_SHORT_PRESS==key_get_state(KEY_1)){//1短按
        point--;
        if(point<0){
            point=2;
        }
    }
    if(KEY_SHORT_PRESS==key_get_state(KEY_4)){//4短按
        point++;
        if(point>2){
            point=0;
        }
    }
    if(KEY_SHORT_PRESS==key_get_state(KEY_2)){//2短按
        first_page();
    }
    if(KEY_SHORT_PRESS==key_get_state(KEY_3)){//3短按
        switch(point){
            case 0:now_page=START;break;
            case 1:now_page=TET;break;
            case 2:now_page=CP;break;
        }
    }
}


/*页面显示模板
void page_xx_show(){
  //oled_show_string(0,0,""                );
  //oled_show_string(0,1,""                );
  //oled_show_string(0,2,""                );
  //oled_show_string(0,3,""                );
  //oled_show_string(0,4,""                );
  //oled_show_string(0,5,""                );
  //oled_show_string(0,6,""                );
  //oled_show_string(0,7,""                );

  //oled_show_string(0,0+point,"->"        );
}
  页面操作模板
void page_xx_ex(){
    if(KEY_SHORT_PRESS==key_get_state(KEY_1)){//1短按
        point--;
        if(point<0){
            point=;
        }
    }
    if(KEY_SHORT_PRESS==key_get_state(KEY_4)){//4短按
        point++;
        if(point>){
            point=0;
        }
    }
    if(KEY_SHORT_PRESS==key_get_state(KEY_2)){//2短按
        
    }
    if(KEY_SHORT_PRESS==key_get_state(KEY_3)){//3短按
        switch(point){
            case 0:now_page=;break;
            case 1:now_page=;break;
            case 2:now_page=;break;
        }
    }
}
*/
